title = "Average Drug Offense Rate per 10,000 People (2020–2024)",
x = "Year",
y = "Average Drug Offense Rate",
color = "County"
) +
theme_minimal()
gc()
school = read_csv('Cleaned Data/cleanSchool.csv')
south_yorkshire <- school %>%
filter(County == "SOUTH YORKSHIRE") %>%
group_by(District)
west_yorkshire <- school %>%
filter(County == "WEST YORKSHIRE") %>%
group_by(District)
district_scores <- school %>%
group_by(District) %>%
summarise(avg_score = mean(ATT8SCR, na.rm = TRUE))
ggplot(south_yorkshire, aes(x = District, y = ATT8SCR)) +
geom_boxplot(fill = "skyblue", color = "darkblue") +
labs(
title = "Boxplot of Average Attainment 8 Score – South Yorkshire",
x = "District",
y = "Attainment 8 Score"
) +
theme_minimal()
ggplot(west_yorkshire, aes(x = District, y = ATT8SCR)) +
geom_boxplot(fill = "purple", color = "pink") +
labs(
title = "Boxplot of Average Attainment 8 Score – South Yorkshire",
x = "District",
y = "Attainment 8 Score"
) +
theme_minimal()
ggplot(district_scores, aes(x = District, y = avg_score, group = 1)) +
geom_point(size = 3, color = "green") +
labs(
title = "Average Attainment 8 Score by District (2024)",
x = "District",
y = "Average Attainment 8 Score"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
gc()
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
ds_band <- band %>%
inner_join(towns %>% select(shortPostcode, District), by = "shortPostcode")
View(ds_band)
View(ds_band)
avg_band <- band %>%
group_by(District) %>%
summarise(avg_bandwidth = mean(Avg_download, na.rm = TRUE))
View(avg_band)
avg_crime_rate <- crime %>%
group_by(District) %>%
summarise(avg_crime = n()) %>%
filter(avg_crime > 1000) %>%
filter(!is.na(District))
View(avg_crime_rate)
avg_house_prices <- house %>%
filter(Year == "2024") %>%
group_by(District) %>%
summarise(avg_price = mean(Price, na.rm=TRUE))
View(avg_house_prices)
avg_population <- towns %>%
group_by(District) %>%
summarise(
avg_2024 = mean(Population2024, na.rm = TRUE)
)
View(avg_population)
combined_data <- avg_band %>%
inner_join(avg_crime_rate, by="District") %>%
inner_join(avg_house_prices, by="District") %>%
inner_join(avg_population, by="District")
combined_data <- combined_data %>%
mutate(across(c(avg_price, avg_crime, avg_2024, avg_bandwidth), as.numeric))
normalize <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
combined_data <- combined_data %>%
mutate(
norm_bandwidth = normalize(avg_bandwidth),         # Higher is better
norm_price = 1 - normalize(avg_price), # Lower is better
norm_rate = 1 - normalize(avg_crime),   # Lower is better
norm_pop = 1 - normalize(avg_2024), # Lower is better
)
combined_data <- combined_data %>%
mutate(
score = 0.3 * norm_bandwidth +
0.3 * norm_rate +
0.3 * norm_price +
0.1 * norm_pop
)
combined_data <- combined_data %>%
mutate(
rating_score_scaled = 1 + 9 * (score - min(score)) / (max(score) - min(score)),
rating_1_to_10 = round(rating_score_scaled, 0),
recommendation = case_when(
rating_1_to_10 <= 5 ~ "Not recommended",
rating_1_to_10 > 5 & rating_1_to_10 <= 8 ~ "Recommended",
rating_1_to_10 >= 9 ~ "Highly recommended"
)
) %>%
arrange(desc(rating_1_to_10))
View(combined_data)
combined_data <- avg_band %>%
inner_join(avg_crime_rate, by="District") %>%
inner_join(avg_house_prices, by="District") %>%
inner_join(avg_population, by="District")
avg_crime_rate <- crime %>%
mutate(District = toupper(District)) %>%
group_by(District) %>%
summarise(avg_crime = n()) %>%
filter(avg_crime > 1000) %>%
filter(!is.na(District))
combined_data <- avg_band %>%
inner_join(avg_crime_rate, by="District") %>%
inner_join(avg_house_prices, by="District") %>%
inner_join(avg_population, by="District")
View(combined_data)
combined_data <- combined_data %>%
mutate(across(c(avg_price, avg_crime, avg_2024, avg_bandwidth), as.numeric))
normalize <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
combined_data <- combined_data %>%
mutate(
norm_bandwidth = normalize(avg_bandwidth),         # Higher is better
norm_price = 1 - normalize(avg_price), # Lower is better
norm_rate = 1 - normalize(avg_crime),   # Lower is better
norm_pop = 1 - normalize(avg_2024), # Lower is better
)
combined_data <- combined_data %>%
mutate(
score = 0.3 * norm_bandwidth +
0.3 * norm_rate +
0.3 * norm_price +
0.1 * norm_pop
)
combined_data <- combined_data %>%
mutate(
rating_score_scaled = 1 + 9 * (score - min(score)) / (max(score) - min(score)),
rating_1_to_10 = round(rating_score_scaled, 0),
recommendation = case_when(
rating_1_to_10 <= 5 ~ "Not recommended",
rating_1_to_10 > 5 & rating_1_to_10 <= 8 ~ "Recommended",
rating_1_to_10 >= 9 ~ "Highly recommended"
)
) %>%
arrange(desc(rating_1_to_10))
write_csv(combined_data, "Recommended System/Recommend.csv")
gc()
library(tidyverse)
library(dplyr)
library(stringr)
library(readr)
library(lubridate)
library(ggplot2)
library(scales)
library(fmsb)
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
View(band)
lm_band <- band %>%
select(Avg_download, postcode) %>%
inner_join(house %>% select(Postcode, Price, County),
by = "Postcode") %>%
distinct(postcode, .keep_all = TRUE)
View(house)
lm_band <- band %>%
select(Avg_download, Postcode) %>%
inner_join(house %>% select(Postcode, Price, County),
by = "Postcode") %>%
distinct(postcode, .keep_all = TRUE)
lm_band <- band %>%
select(Avg_download, Postcode) %>%
inner_join(house %>% select(Postcode, Price, County),
by = "Postcode") %>%
distinct(Postcode, .keep_all = TRUE)
View(lm_band)
gc()
house %>%
filter(County == "WEST YORKSHIRE") %>%
distinct(District)
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
house %>%
filter(County == "WEST YORKSHIRE") %>%
distinct(District)
lm_band <- band %>%
select(Avg_download, Postcode) %>%
inner_join(house %>% select(Postcode, Price, County),
by = "Postcode") %>%
distinct(Postcode, .keep_all = TRUE)
ggplot(lm_band, aes(x = Avg_download, y = Price)) +
geom_point(aes(color = County), alpha = 0.6) +
scale_color_manual(values = c("SOUTH YORKSHIRE" = "red", "WEST YORKSHIRE" = "green")) +
geom_smooth(data = subset(lm_band, County == "SOUTH YORKSHIRE"), method = "lm", se = FALSE, color = "blue", size = 1.2) +
geom_smooth(data = subset(lm_band, County == "WEST YORKSHIRE"), method = "lm", se = FALSE, color = "orange", size = 1.2) +
scale_y_log10() +
scale_x_log10() +
coord_cartesian(xlim = c(5, 150)) +  # adjust these limits based on your data
theme_minimal() +
labs(title = "House Price vs Download Speed by County (log scale)",
x = "Download Speed (Mbit/s)",
y = "House Price (£)",
color = "County")
lm_full <- lm(Price ~ Avg_download, data = lm_band)
summary(lm_full)
cor_full <- cor(lm_band$Price, lm_band$Avg_download, use = "complete.obs")
cat("Correlation between House Price and Download Speed:", round(cor_full, 3), "\n")
gc()
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
lm_ha <- school %>%
inner_join(house %>% select(Price,shortPostcode), by="shortPostcode") %>%
mutate(
ATT8SCR = as.numeric(ATT8SCR),
Price = as.numeric(Price)
) %>%
filter(!is.na(ATT8SCR) & !is.na(Price)) %>%
distinct(URN, .keep_all = TRUE)
ggplot(lm_ha, aes(x = Price, y = ATT8SCR, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Attainment 8 Score vs House Price (2024)",
x = "Average House Price (GBP)",
y = "Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
correlation <- cor(lm_ha$ATT8SCR, lm_ha$Price, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
model <- lm(ATT8SCR ~ Price, data = lm_ha)
summary(model)
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
View(towns)
pop_district <- towns %>%
group_by(District) %>%
select(Population2024, District, County) %>%
summarise(avg_pop2024 = mean(Population2024))
View(pop_district)
pop_district <- towns %>%
group_by(District, County) %>%
select(Population2024, District, County) %>%
summarise(avg_pop2024 = mean(Population2024))
View(crime)
drug_crime <- crime %>%
filter(`Crime type` == "Drugs") %>%
group_by(District, County) %>%
summarise(drug_crime_district = n())
View(drug_crime)
drug_crime <- crime %>%
filter(`Crime type` == "Drugs") %>%
group_by(District, County) %>%
summarise(drug_crime_district = n()) %>%
filter(drug_crime_district > 100) %>%
drop_na(District)
drug_crime <- crime %>%
filter(`Crime type` == "Drugs") %>%
group_by(District) %>%
summarise(drug_crime_district = n()) %>%
filter(drug_crime_district > 100) %>%
drop_na(District)
View(pop_district)
drug_crime_rate <- drug_crime %>%
inner_join(pop_district, by = "District") %>%
mutate(drug_district = (drug_crime_district/avg_pop2024) * 10000)
View(drug_crime_rate)
drug_crime <- crime %>%
filter(`Crime type` == "Drugs") %>%
mutate(District = toupper(District)) %>%
group_by(District) %>%
summarise(drug_crime_district = n()) %>%
filter(drug_crime_district > 100) %>%
drop_na(District)
drug_crime_rate <- drug_crime %>%
inner_join(pop_district, by = "District") %>%
mutate(drug_district = (drug_crime_district/avg_pop2024) * 10000)
View(drug_crime_rate)
summarise(pop2024 = sum(Population2024))
summarise(pop2024 = sum(towns$Population2024))
View(towns)
View(school)
lm_crime <- drug_crime_rate %>%
inner_join(school, by = "District")
View(lm_crime)
lm_crime <- drug_crime_rate %>%
select(-County) %>%
inner_join(school, by = "District")
ggplot(lm_crime, aes(x = drug_district, y = ATT8SCR, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
avg_8 <- school %>%
select(District, ATT8SCR) %>%
group_by(County) %>%
summarise(avg_scr = mean(ATT8SCR))
avg_8 <- school %>%
select(District, ATT8SCR) %>%
group_by(District) %>%
summarise(avg_scr = mean(ATT8SCR))
View(avg_8)
View(avg_8)
lm_crime <- avg_8 %>%
inner_join(school, by = "District")
ggplot(lm_crime, aes(x = drug_district, y = ATT8SCR, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
lm_crime <- drug_crime_rate %>%
inner_join(avg_8, by = "District")
ggplot(lm_crime, aes(x = drug_district, y = avg_scr, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
lm_crime <- drug_crime_rate %>%
select(-County) %>%
inner_join(school, by = "District")
ggplot(lm_crime, aes(x = drug_district, y = ATT8SCR, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
lm_crime_avg <- drug_crime_rate %>%
inner_join(avg_8, by = "District")
View(lm_crime_avg)
correlation <- cor(lm_crime$ATT8SCR, lm_crime$drug_district, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
correlation <- cor(lm_crime_avg$avg_scr, lm_crime$drug_district, use = "complete.obs")
correlation <- cor(lm_crime$ATT8SCR, lm_crime$drug_district, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
correlation <- cor(lm_crime_avg$avg_scr, lm_crime$drug_district, use = "complete.obs")
correlation <- cor(lm_crime_avg$avg_scr, lm_crime_avg$drug_district, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
model <- lm(avg_scr ~ drug_data, data = lm_crime_avg)
model <- lm(avg_scr ~ drug_district, data = lm_crime_avg)
summary(model)
gc()
gc()
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
pop_district <- towns %>%
group_by(District, County) %>%
select(Population2024, District, County) %>%
summarise(avg_pop2024 = mean(Population2024))
drug_crime <- crime %>%
filter(`Crime type` == "Drugs") %>%
mutate(District = toupper(District)) %>%
group_by(District) %>%
summarise(drug_crime_district = n()) %>%
filter(drug_crime_district > 100) %>%
drop_na(District)
drug_crime_rate <- drug_crime %>%
inner_join(pop_district, by = "District") %>%
mutate(drug_district = (drug_crime_district/avg_pop2024) * 10000)
View(band)
View(drug_crime_rate)
avg_download <- band %>%
group_by(District) %>%
summarise(avg_band = mean(avg_download))
avg_download <- band %>%
group_by(District) %>%
summarise(avg_band = mean(Avg_download))
lm_download <- drug_crime_rate %>%
inner_join(avg_download, by="District")
View(lm_download)
unique(band$District)
View(avg_download)
avg_download <- band %>%
group_by(District) %>%
summarise(avg_band = mean(Avg_download, na.rm = TRUE))
View(avg_download)
lm_download <- drug_crime_rate %>%
inner_join(avg_download, by="District")
ggplot(lm_download, aes(x = drug_district, y = avg_band, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Average Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Average Attainment 8 Score",
color = "County",
fill = "County"
) +
theme_minimal()
ggplot(lm_download, aes(x = drug_district, y = avg_band, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Average Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Average Download Speed",
color = "County",
fill = "County"
) +
theme_minimal()
correlation <- cor(lm_download$avg_band, lm_crime_avg$drug_district, use = "complete.obs")
correlation <- cor(lm_download$avg_band, lm_download$drug_district, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
model <- lm(avg_band ~ drug_district, data = lm_download)
summary(model)
gc()
towns = read_csv('Cleaned Data/Towns.csv')
house = read_csv('Cleaned Data/cleanHousePrices.csv')
crime = read_csv('Cleaned Data/cleanCrimeRate.csv')
band = read_csv('Cleaned Data/cleanBand.csv')
school = read_csv('Cleaned Data/cleanschool.csv')
avg_download <- band %>%
group_by(District) %>%
summarise(avg_band = mean(Avg_download, na.rm = TRUE))
avg_8 <- school %>%
select(District, ATT8SCR) %>%
group_by(District) %>%
summarise(avg_scr = mean(ATT8SCR))
View(avg_8)
avg_download <- band %>%
group_by(District, County) %>%
summarise(avg_band = mean(Avg_download, na.rm = TRUE))
ggplot(lm_download, aes(x = drug_district, y = avg_band, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Average Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Average Download Speed",
color = "County",
fill = "County"
) +
theme_minimal()
lm_band_school <- avg_download %>%
inner_join(avg_8, by = "District")
View(lm_band_school)
ggplot(lm_band_school, aes(x = avg_scr, y = avg_band, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Average Attainment 8 Score vs Drug rate per 10000",
x = "Drug rate per 10,000",
y = "Average Download Speed",
color = "County",
fill = "County"
) +
theme_minimal()
ggplot(lm_band_school, aes(x = avg_scr, y = avg_band, color = County)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, aes(fill = County), alpha = 0.2) +
labs(
title = "Average Attainment 8 Score vs Drug rate per 10000",
x = "Avera attainment 8",
y = "Average Download Speed",
color = "County",
fill = "County"
) +
theme_minimal()
correlation <- cor(lm_band_school$avg_band, lm_band_school$avg_scr, use = "complete.obs")
print(paste("Correlation between Attainment 8 score and House Price:", round(correlation, 3)))
model <- lm(avg_band ~ avg_scr, data = lm_band_school)
summary(model)
load("C:/All assignment/Bishnu Mahato 230296/.RData")
cd "C:/All assignment/Bishnu Mahato 230296"
git init
cd "C:/All assignment/Bishnu Mahato 230296"
cd "C:/All assignment/Bishnu Mahato 230296"
git init
